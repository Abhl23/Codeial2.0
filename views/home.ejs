<h1><%= title %></h1>

<section id="feed-posts">
  <h4>Posts</h4>

  <% if(locals.user) { %>
  <form action="/posts/create" method="post" id="new-post-form">
    <textarea
      name="content"
      cols="30"
      rows="3"
      placeholder="Type Here..."
    ></textarea>
    <button type="submit">Post</button>
  </form>
  <% } %>
</section>

<div id="posts-list-container">
  <ul>
    <% for(let post of posts) { %>
    <li id="post-<%= post.id %>">
      <p>
        <% if(locals.user && locals.user.id == post.user.id) { %>
        <small>
          <a href="/posts/destroy/<%= post._id %>">X</a>
        </small>
        <% } %>
        <%= post.content %>
        <br />
        <strong><%= post.user.name %></strong>
      </p>

      <div class="post-comments-container">
        <% if(locals.user) { %>
        <form action="/comments/create" method="post">
          <input type="text" name="content" placeholder="Add a comment..." />
          <input type="hidden" name="post" value="<%= post._id %>" />
          <button type="submit">Add Comment</button>
        </form>
        <% } %>

        <div class="post-comments-list">
          <ul id="post-comments-<%= post._id %>">
            <% for(let comment of post.comments) { %>
            <li>
              <p>
                <%= comment.content %>
                <br />
                <small><%= comment.user.name %></small>
              </p>
            </li>
            <% } %>
          </ul>
        </div>
      </div>
    </li>
    <%} %>
  </ul>
</div>
